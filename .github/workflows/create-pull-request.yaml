name: Run the Action on each commit
on:
  push:
    branches:
      - feature/**

jobs:
  pull-request:
    name: Open PR to main
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      name: checkout

    - uses: repo-sync/pull-request@v2
      name: pull-request
      with:
        destination_branch: "main"
        pr_title: "Pulling ${{ github.ref_name }} into main"
        pr_body: "ðŸ‘‘ *An automated PR*"
        pr_draft: false
        github_token: ${{ secrets.GITHUB_TOKEN }}

    - name: build_artifact
      run: |
        printf "$(java -version)\n"
        printf "$(mvn -version)\n"
        printf "\ncurrent_dir: $PWD\n"
        
        cd java/hello-world-v1/
        printf "current_dir: $PWD\n"
        printf "building java artifact!\n"
        mvn clean install \
        --threads 2C \
        --quiet \
        --file pom.xml
        cd target
        printf "\ncurrent_dir: $PWD\n"
        ls -l
        cp *.jar ~/artifact.jar
        echo "GITHUB_REPOSITORY: $GITHUB_REPOSITORY"
        echo "GITHUB_WORKSPACE: $GITHUB_WORKSPACE"
        echo "HOME: $HOME"        
