name: sharing-artifacts

on:
  push:
    paths: 
      - ".github/workflows/workflow-04.yaml"

jobs:

  Android:
    runs-on: ubuntu-latest
    steps:
      - name: checkout_main_branch
        uses: actions/checkout@v3
        with:
          ref: main

      - name: list_checkout_files
        run: |
          printf "\n$PWD\n"
          ls -l

          cd java
          printf "\n$PWD\n"          
          ls -l
        
          cd hello-world-v1
          printf "\n$PWD\n"
          ls -l

      - name: build_artifact
        run: |
          printf "$(java -version)\n"
          printf "$(mvn -version)\n"

          printf "\ncurrent_dir: $PWD\n"
          cd java/hello-world-v1/
          printf "current_dir: $PWD\n"
          ls ".github/workflows/workflow-04.yaml"

          printf "building java artifact!\n"
          mvn clean install \
          --threads 2C \
          --quiet \
          --file pom.xml

      - name: upload_artifact
        uses: actions/upload-artifact@v3
        with:
          name: hello-world-v1-artifact
          path: "."

  AppCenterDistibuteDroid:
      runs-on: ubuntu-latest
      needs: Android
      steps:
        - name: download_artifact
          uses: actions/download-artifact@v3
          with:
            name: hello-world-v1-artifact

        - name: list_checkout_files
          run: |
            printf "\n$PWD\n"
            ls -l                
